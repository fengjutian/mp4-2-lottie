<!DOCTYPE html>
<html lang="zh">

<head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta http-equiv="Cross-Origin-Opener-Policy" content="same-origin">
      <meta http-equiv="Cross-Origin-Embedder-Policy" content="require-corp">
      <title>MP4 拆帧 → Lottie</title>
      <style>
            html,
            body {
                  height: 100%;
                  width: 100%;
            }

            body {
                  background: lightgoldenrodyellow;
                  display: flex;
                  flex-direction: column;
                  align-items: center;
                  margin: 0;
                  padding: 20px;
                  font-family: Arial, sans-serif;
            }

            h2 {
                  text-align: center;
            }

            #lottieContainer {
                  margin-top: 20px;
                  min-width: 400px;
                  min-height: 200px;
            }

            .controls {
                  display: flex;
                  flex-direction: row;
                  align-items: center;
            }

            #lottieContainer {
                  border: 1px dashed lightgreen;
            }

            .main {
                  display: flex;
                  flex-direction: column;
                  align-items: flex-start;
                  /* width: 80%; */
                  width: 450px;

            }

            .button-group {
                  display: flex;
                  gap: 10px;
                  margin-bottom: 10px;
            }

            button {
                  padding: 8px 16px;
                  background-color: #4CAF50;
                  color: white;
                  border: none;
                  border-radius: 4px;
                  cursor: pointer;
                  font-size: 14px;
            }

            button:hover:not(:disabled) {
                  background-color: #45a049;
            }

            button:disabled {
                  background-color: #cccccc;
                  cursor: not-allowed;
            }

            .param-hint {
                  font-size: 10px;
                  color: #666;
                  margin-left: 5px;
                  margin-right: 15px;
            }

            .controls {
                  display: flex;
                  flex-wrap: wrap;
                  align-items: center;
                  gap: 5px 10px;
            }
      </style>
</head>

<body>
      <div class="main">
            <h2>MP4 拆帧 → Lottie 动画</h2>

            <p>1. 视频分拆为帧 </p>
            <input type="file" id="file" accept="video/mp4" />

            <p>2. 属性配置</p>
            <div class="controls">
                  <div>
                        <label>FPS: <input id="fps" type="number" value="10" min="1" max="60"></label>
                        <small class="param-hint">影响流畅度，值越低文件越小</small>
                  </div>

                  <div>
                        <label>Scale: <input id="scale" type="number" value="0.5" step="0.1" min="0.1" max="1"></label>
                        <small class="param-hint">控制尺寸，0.5表示原图一半大小</small>


                  </div>

                  <div>

                        <label>Max Frames: <input id="maxFrames" type="number" value="100" min="1" max="1000"></label>
                        <small class="param-hint">限制帧数，最有效减小文件大小的参数</small>


                  </div>

                  <!-- 添加图片质量控制 -->
                  <label>图片质量: <input id="imageQuality" type="range" min="0.1" max="1" step="0.1" value="0.8"></label>
                  <span id="qualityValue">0.8</span>
                  <small class="param-hint">0.8为平衡值，值越低压缩率越高</small>
            </div>

            <p>3. 转换为 Lottie 动画</p>
            <div class="button-group">
                  <button id="run">开始转换</button>
                  <button id="exportBtn" disabled>导出 JSON</button>
            </div>
            <progress id="progress" value="0" max="100" style="width:300px;"></progress>
            <span id="progressText"></span>
            <div id="status"></div>
            <p>4. 播放 Lottie 动画</p>
            <div id="lottieContainer"></div>

      </div>




      <!-- ✅ 注意：先加载 ffmpeg、再加载 lottie、最后加载 main.js -->
      <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.11.1/dist/ffmpeg.min.js"></script>
      <script src="https://unpkg.com/lottie-web/build/player/lottie.min.js"></script>
      <script src="./main.js"></script>
</body>

</html>